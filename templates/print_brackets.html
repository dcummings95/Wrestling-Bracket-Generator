<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>{{ event.name }} - Print Brackets</title>
    <style>
        * { box-sizing: border-box; margin: 0; padding: 0; }
        
        @page { 
            size: letter portrait;
            margin: 0.5in; 
        }
        
        body { 
            font-family: Arial, sans-serif; 
            font-size: 11pt; 
        }
        
        .event-header { 
            text-align: center; 
            margin-bottom: 20px; 
            padding-bottom: 10px;
            border-bottom: 2px solid #000;
        }
        .event-header h1 { font-size: 18pt; margin-bottom: 5px; }
        .event-header p { font-size: 10pt; color: #666; }
        
        .bracket {
            page-break-after: always;
            border: 2px solid #000;
            padding: 15px;
            min-height: 9in;
        }
        .bracket:last-child {
            page-break-after: auto;
        }
        
        .bracket-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-weight: bold;
            margin-bottom: 10px;
            padding-bottom: 8px;
            border-bottom: 2px solid #ccc;
            font-size: 12pt;
        }
        
        .bracket-meta {
            display: flex;
            justify-content: space-between;
            font-size: 10pt;
            color: #666;
            margin-bottom: 15px;
        }
        
        table { 
            width: 100%; 
            border-collapse: collapse; 
            font-size: 10pt;
            margin-bottom: 20px;
        }
        th, td { 
            border: 1px solid #333; 
            padding: 6px 8px; 
            text-align: left; 
        }
        th { 
            background: #f0f0f0;
            font-weight: bold;
        }
        
        .matchups { margin-top: 20px; }
        .matchups h4 { 
            font-size: 11pt; 
            margin-bottom: 10px;
            padding: 5px;
            background: #f0f0f0;
        }
        .match-row { 
            display: flex; 
            border: 1px solid #333; 
            margin-bottom: 5px;
            font-size: 10pt;
        }
        .match-wrestler { 
            flex: 1; 
            padding: 5px 8px;
            border-right: 1px solid #333;
        }
        .match-wrestler:last-child { border-right: none; }
        .match-score { 
            width: 50px; 
            text-align: center;
            border-left: 1px solid #333;
            background: #fafafa;
        }
        
        .unmatched-page {
            page-break-before: always;
        }
        .unmatched h2 { 
            font-size: 14pt; 
            margin-bottom: 15px;
            padding: 10px;
            background: #ffe6e6;
            border-left: 4px solid #c00;
        }
        
        @media print {
            .no-print { display: none; }
            body { padding: 0; }
        }
    </style>
</head>
<body>
    <div class="no-print" style="margin-bottom: 20px; padding: 15px; background: #f5f5f5;">
        <button onclick="window.print()" style="padding: 10px 20px; font-size: 14pt; cursor: pointer;">
            üñ®Ô∏è Print Brackets
        </button>
        <a href="{{ url_for('view_event', event_id=event.id) }}" style="margin-left: 10px;">‚Üê Back to Event</a>
        <span style="margin-left: 20px; color: #666;">{{ event.brackets|length }} brackets ready to print</span>
    </div>

    {% for bracket in event.brackets %}
    <div class="bracket">
        <div class="event-header">
            <h1>{{ event.name }}</h1>
            <p>{{ event.date }}</p>
        </div>

        <div class="bracket-header">
            <span>Bracket {{ bracket.letter_label }}</span>
            <span>Mat {{ bracket.mat_number }}</span>
        </div>

        <div class="bracket-meta">
            <span>Weight: {{ bracket.weight_range[0] }}-{{ bracket.weight_range[1] }} lbs</span>
            <span>Grades: {{ bracket.grade_range_display[0] }} - {{ bracket.grade_range_display[1] }}</span>
            <span>{{ bracket.wrestlers|length }} wrestlers</span>
        </div>
        
        <table>
            <thead>
                <tr>
                    <th>Name</th>
                    <th>Grade</th>
                    <th>Weight</th>
                    <th>Rank</th>
                    <th>School</th>
                </tr>
            </thead>
            <tbody>
                {% for w in bracket.wrestlers %}
                <tr>
                    <td>{{ w.full_name }}</td>
                    <td>{{ w.grade_display }}</td>
                    <td>{{ w.weight }}</td>
                    <td>{{ w.rank }}</td>
                    <td>{{ w.school }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>

        <div class="matchups">
            <h4>Matchups (Round Robin)</h4>
            {% set wrestlers = bracket.wrestlers %}
            {% for i in range(wrestlers|length) %}
                {% for j in range(i + 1, wrestlers|length) %}
                <div class="match-row">
                    <div class="match-wrestler">{{ wrestlers[i].full_name }}</div>
                    <div class="match-score"></div>
                    <div class="match-wrestler">{{ wrestlers[j].full_name }}</div>
                    <div class="match-score"></div>
                </div>
                {% endfor %}
            {% endfor %}
        </div>
    </div>
    {% endfor %}

    {% if event.unmatched_wrestlers %}
    <div class="unmatched-page">
        <div class="unmatched">
            <h2>Unmatched Wrestlers</h2>
            <table>
                <thead>
                    <tr>
                        <th>Name</th>
                        <th>Grade</th>
                        <th>Weight</th>
                        <th>Rank</th>
                        <th>School</th>
                    </tr>
                </thead>
                <tbody>
                    {% for w in event.unmatched_wrestlers %}
                    <tr>
                        <td>{{ w.full_name }}</td>
                        <td>{{ w.grade_display }}</td>
                        <td>{{ w.weight }}</td>
                        <td>{{ w.rank }}</td>
                        <td>{{ w.school }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
    {% endif %}
</body>
</html>